webpackJsonp([1],{"+94j":function(t,e,a){var i=a("bKTw");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("b67d32d6",i,!0)},"9bBU":function(t,e,a){a("mClu");var i=a("FeBl").Object;t.exports=function(t,e,a){return i.defineProperty(t,e,a)}},C4MV:function(t,e,a){t.exports={default:a("9bBU"),__esModule:!0}},KdrZ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("bOdI"),s=a.n(i),r=a("uUes"),n={data:function(){return{formData:{},form:{content:"",coverUrl:"",billId:-1},baseURL:"https://ifarm.iqiys.cn/api/oss",hasData:!1,dialogFormVisible:!1,billId:this.$route.params.billid,reportList:[],addMedia:[],editFlag:!1,dialogVisible2:!1,dialogImageUrl:"",currentPage:1,totalNum:1}},created:function(){var t=this;Object(r.p)(this.billId).then(function(e){t.formData=e.data.content[0],t.hasData=!0}),this.getReportlist()},methods:{getReportlist:function(){var t=this;Object(r.n)({page:this.currentPage-1,size:10},this.billId).then(function(e){t.reportList=e.data.content,t.totalNum=e.data.totalElements})},handleCurrentChange:function(t){this.currentPage=t,this.getReportlist()},uploadImg:function(){this.$router.push({name:"vegetableInfo"})},editNewReport:function(t,e){var a=this;this.dialogFormVisible=!0,this.form.reportid=t,-1!==e?(this.editFlag=!0,this.form.content=this.reportList[e].content,this.addMedia=[],this.reportList[e].medias.map(function(t,e){a.addMedia.push({id:t.id,url:t.url})})):(this.addMedia=[],this.form.content="",this.editFlag=!1)},deleteReport:function(t,e){var a=this;Object(r.f)(t).then(function(t){200==t.status?(a.$message({message:"删除成功",type:"success"}),a.reportList.splice(e,1)):a.$message({message:"删除失败",type:"warning"})})},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url||t.coverUrl,this.dialogVisible2=!0},compareTime:function(t){var e=new Date(t),a=new Date;return new Date(Date.parse(e))>a?"未过期":"已过期"},handelErrorForm:function(){return""==this.form.content?(this.$message({message:"汇报内容不能为空",type:"warning"}),!1):0!=this.addMedia.length||(this.$message({message:"汇报图片至少一张",type:"warning"}),!1)},submitRes:function(){var t=this;this.handelErrorForm()?this.editFlag?Object(r.k)(s()({id:this.form.reportid,content:this.form.content,medias:this.addMedia},"content",this.form.content)).then(function(e){200==e.status?(t.dialogFormVisible=!1,t.$message({message:"修改成功",type:"success"}),t.dialogFormVisible=!1,t.getReportlist()):t.$message({message:"修改失败",type:"warning"})}):Object(r.c)(s()({billId:this.billId,content:this.form.content,medias:this.addMedia},"content",this.form.content)).then(function(e){200==e.status?(t.dialogFormVisible=!1,t.$message({message:"添加成功",type:"success"}),t.dialogFormVisible=!1,t.getReportlist()):t.$message({message:"添加失败",type:"warning"})}):console.log("表单提交失败")},handleImagebeforeUpload:function(t){this.addMedia.length>=9&&this.$message({message:"照片数量限制9张",type:"warning"})},handleImageScucess:function(t,e,a){this.addMedia.push({type:0,url:t.data})},handleImageScucess2:function(t,e,a){var i=this;Object(r.j)({id:this.billId,coverUrl:t.data}).then(function(e){200==e.status?(i.$message({message:"修改成功",type:"success"}),i.formData.coverUrl=t.data):i.$message({message:"修改失败",type:"warning"})})},handleRemove:function(t,e){var a=this;this.editFlag?this.addMedia.map(function(e,i){e.url==t.url&&a.addMedia.splice(i,1)}):this.addMedia.map(function(e,i){e.url==t.response.data&&a.addMedia.splice(i,1)})}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.hasData?a("div",{staticClass:"app-container"},[a("el-form",{attrs:{model:t.formData}},[a("el-form-item",{attrs:{label:"菜地分区：","label-width":"150px"}},[t._v("\n      "+t._s(t.formData.gardenItem.gardenArea.name)+"   "+t._s(t.formData.gardenItem.sn)+"\n    ")]),t._v(" "),a("el-form-item",{attrs:{label:"有效期：","label-width":"150px"}},[a("span",[t._v(t._s(t._f("parseTime")(t.formData.startTime,"{y}-{m}-{d}")))]),t._v(" ~ "),a("span",[t._v(t._s(t._f("parseTime")(t.formData.endTime,"{y}-{m}-{d}")))]),t._v("\n        ("+t._s(t.compareTime(t.formData.endTime))+")\n    ")]),t._v(" "),a("el-form-item",{attrs:{label:"用户昵称：","label-width":"150px"}},[t._v("\n      "+t._s(t.formData.user.nickName)+"\n    ")]),t._v(" "),a("el-form-item",{attrs:{label:"手机号：","label-width":"150px"}},[t._v("\n      "+t._s(t.formData.user?t.formData.user.phone:t.formData.address?t.formData.address.phone:"--")+"\n    ")]),t._v(" "),a("el-form-item",{attrs:{label:"默认收货信息：","label-width":"150px"}},[t._v("\n      "+t._s(t.formData.address?t.formData.address.province+t.formData.address.city+t.formData.address.area+t.formData.address.address:"--")+"\n      "),a("p",[t._v(t._s(t.formData.address?t.formData.address.name+" "+t.formData.address.phone:"--"))])]),t._v(" "),a("el-form-item",{attrs:{label:"菜地主图：","label-width":"150px"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"","on-success":t.handleImageScucess2,action:t.baseURL}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])])]),t._v(" "),a("img",{staticStyle:{"vertical-align":"middle","max-width":"300px","max-height":"250px",cursor:"pointer"},attrs:{src:t.formData.coverUrl,alt:"",title:"点击修改菜地主图",width:"80%",height:"80%"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"管家汇报：","label-width":"150px"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(e){t.editNewReport(-1,-1)}}},[t._v("添加汇报")])],1),t._v(" "),a("el-form-item",{attrs:{label:"","label-width":"150px"}},[t._l(t.reportList,function(e,i){return 0!==t.reportList.length?a("div",{staticStyle:{"margin-bottom":"5px"}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v(t._s(t._f("parseTime")(e.createTime)))]),t._v(" "),a("el-button",{staticStyle:{padding:"5px","margin-left":"40px"},attrs:{type:"text"},on:{click:function(a){t.editNewReport(e.id,i)}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticStyle:{padding:"5px","margin-left":"20px"},attrs:{type:"text"},on:{click:function(a){t.deleteReport(e.id,i)}}},[t._v("删除")])],1),t._v(" "),a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"line-height":"22px",display:"inline-block"}},[t._v(t._s(e.content))])]),t._v(" "),t._l(e.medias,function(e){return a("div",{staticClass:"text item",staticStyle:{display:"inline-block"}},[a("img",{staticStyle:{"max-width":"200px","max-height":"150px",cursor:"pointer"},attrs:{src:e.url,alt:"",width:"80%",height:"80%"},on:{click:function(a){t.handlePictureCardPreview(e)}}})])})],2)],1):t._e()}),t._v(" "),0!==t.reportList.length?a("div",[t.totalNum/10>1?a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":[1,10,20,30],"page-size":10,layout:"total, prev, pager, next, jumper",total:t.totalNum},on:{"current-change":t.handleCurrentChange}}):t._e()],1):t._e(),t._v(" "),0==t.reportList.length?a("div",{staticStyle:{display:"inline-block",cursor:"pointer"},on:{click:function(e){t.editNewReport(-1,-1)}}},[t._v("\n        暂无汇报信息，可点击添加\n      ")]):t._e()],2)],1),t._v(" "),a("el-dialog",{attrs:{title:t.editFlag?"编辑汇报":"添加汇报",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"汇报内容：","label-width":"120px"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},"auto-complete":"off"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),t._v(" "),a("div",{staticClass:"huibao-list"},[a("label",{staticClass:"el-form-item__label",staticStyle:{width:"120px"}},[t._v("汇报图片")]),t._v(" "),a("el-upload",{attrs:{action:t.baseURL,"list-type":"picture-card","before-upload":t.handleImagebeforeUpload,"on-preview":t.handlePictureCardPreview,"on-success":t.handleImageScucess,"file-list":t.addMedia,"on-remove":t.handleRemove}},[a("i",{staticClass:"el-icon-plus"})])],1),t._v(" "),t.form.coverUrl?a("div",{staticStyle:{"margin-left":"120px"}},[a("img",{staticStyle:{"max-height":"200px"},attrs:{src:t.form.coverUrl,alt:"",width:"80%",height:"80%"},on:{click:function(e){t.handlePictureCardPreview(t.form)}}})]):t._e()],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitRes()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible2},on:{"update:visible":function(e){t.dialogVisible2=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1):t._e()},staticRenderFns:[]};var l=a("VU/8")(n,o,!1,function(t){a("+94j")},"data-v-0e8afccd",null);e.default=l.exports},bKTw:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.app-container .el-form-item__label[data-v-0e8afccd] {\n  font-size: 16px;\n}\n",""])},bOdI:function(t,e,a){"use strict";e.__esModule=!0;var i,s=a("C4MV"),r=(i=s)&&i.__esModule?i:{default:i};e.default=function(t,e,a){return e in t?(0,r.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},mClu:function(t,e,a){var i=a("kM2E");i(i.S+i.F*!a("+E39"),"Object",{defineProperty:a("evD5").f})}});